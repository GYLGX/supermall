{"remainingRequest":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\src\\views\\detail\\Detail.vue?vue&type=style&index=0&id=117d0e76&scoped=true&lang=css&","dependencies":[{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\src\\views\\detail\\Detail.vue","mtime":1581237807346},{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\前端学习\\开发软件\\前端开发文件\\Vue\\实战项目\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5kZXRhaWwtbmF2IHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgei1pbmRleDogMTA7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKfQoKLmRldGFpbC1zY3JvbGwgewogIHBvc2l0aW9uOiBmaXhlZDsKICB0b3A6IDQ0cHg7CiAgbGVmdDogMDsKICByaWdodDogMDsKICBib3R0b206IDQ5cHg7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICB6LWluZGV4OiA5OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0KCg=="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2LA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\r\n  <div class='Detail' v-show='DetailSwiperImage'>\r\n    <detail-nav-bar class=\"detail-nav\" @titleClick='titleClick' ref='detailNavBar'></detail-nav-bar>\r\n    <scroll class=\"detail-scroll\" :probe-type=3 @scroll='onscrollTop' :pull-up-load='true' ref=\"scroll\">\r\n      <!-- 轮播图 -->\r\n      <detail-swiper :detail-swiper-image='DetailSwiperImage'></detail-swiper>\r\n      <!-- 商品信息 -->\r\n      <detail-base-info :goods='goods'></detail-base-info>\r\n      <!-- 店铺信息 -->\r\n      <detail-shop-info :shops='shops'></detail-shop-info>\r\n      <!-- 图片展示 -->\r\n      <detail-goods-info :goods-info='goodsInfo' @imageload='imageload'></detail-goods-info>\r\n      <!-- 尺码参数 -->\r\n      <detail-param-info ref='params' :param-info='paramInfo'></detail-param-info>\r\n      <!-- 评论区 -->\r\n      <detail-comment-info ref='comment' :comment-info='commentInfo'></detail-comment-info>\r\n      <!-- 推荐 -->\r\n      <goods-list ref='recomment' :goods=\"showGoods\"></goods-list>\r\n    </scroll>\r\n    <back-top @click.native='backClick' v-show='scrollTop' />\r\n    <detail-bottom-bar @addToCart='addToCart'></detail-bottom-bar>\r\n  </div>\r\n</template>\r\n<script>\r\n  import {\r\n    debounce\r\n  } from 'common/utils'\r\n  import {\r\n    scrollTopMixin,\r\n    itemListenerMixin\r\n  } from 'common/mixin';\r\n\r\n  import Scroll from 'components/common/scroll/Scroll';\r\n  import GoodsList from 'components/content/goods/GoodsList'\r\n\r\n  import DetailNavBar from './childComps/DetailNavBar';\r\n  import DetailSwiper from './childComps/DetailSwiper';\r\n  import DetailBaseInfo from './childComps/DetailBaseInfo';\r\n  import DetailShopInfo from './childComps/DetailShopInfo';\r\n  import DetailGoodsInfo from './childComps/DetailGoodsInfo';\r\n  import DetailParamInfo from './childComps/DetailParamInfo';\r\n  import DetailCommentInfo from './childComps/DetailCommentInfo';\r\n  import DetailBottomBar from './childComps/DetailBottomBar'\r\n\r\n  import {\r\n    getdetaildata,\r\n    getRecommend,\r\n    Goods,\r\n    Shop,\r\n    GoodsParam\r\n  } from 'network/detail'\r\n\r\n  export default {\r\n    name: 'Detail',\r\n    components: {\r\n      Scroll,\r\n      GoodsList,\r\n\r\n      DetailNavBar,\r\n      DetailSwiper,\r\n      DetailBaseInfo,\r\n      DetailShopInfo,\r\n      DetailGoodsInfo,\r\n      DetailParamInfo,\r\n      DetailCommentInfo,\r\n      DetailBottomBar\r\n    },\r\n    data() {\r\n      return {\r\n        iid: 0,\r\n        DetailSwiperImage: [],\r\n        goods: {},\r\n        shops: {},\r\n        goodsInfo: {},\r\n        paramInfo: {},\r\n        commentInfo: {},\r\n        showGoods: [],\r\n        DetailScrollY: [],\r\n        debounceFunction: null,\r\n        navIndex: 0\r\n      }\r\n    },\r\n    mixins: [scrollTopMixin],\r\n    created() {\r\n      this.iid = this.$router.currentRoute.query.iid;\r\n      this.getdetaildata(this.iid);\r\n      this.getRecommend();\r\n      this.debounceFunction = debounce(() => {\r\n        //刷新\r\n        this.$refs.scroll.refresh()\r\n        //获取navbaritem每个的对应位置\r\n        this.DetailScrollY = []\r\n        this.DetailScrollY.push(0)\r\n        this.DetailScrollY.push(this.$refs.params.$el.offsetTop)\r\n        this.DetailScrollY.push(this.$refs.comment.$el.offsetTop)\r\n        this.DetailScrollY.push(this.$refs.recomment.$el.offsetTop)\r\n        this.DetailScrollY.push(Number.MAX_VALUE)\r\n      })\r\n    },\r\n    mixins: [scrollTopMixin],\r\n    methods: {\r\n      //事件\r\n      imageload() {\r\n        this.debounceFunction()\r\n      },\r\n      //scroll滚动时的事件监听\r\n      onscrollTop(position) {\r\n        //到指定位置显示置顶图标\r\n        this.showTop(position);\r\n        //绑定对应标题\r\n        this.toCorrespondence(position)\r\n      },\r\n      //绑定对应标题\r\n      toCorrespondence(position) {\r\n        const positionY = -position.y\r\n        const length = this.DetailScrollY.length;\r\n        // console.log(positionY);\r\n        for (let i = 0; i < length - 1; i++) {\r\n          //1 、直接做判断\r\n          // if ((this.navIndex !== i) && (i < length - 1 && this.DetailScrollY[i] <= positionY && positionY < this\r\n          //     .DetailScrollY[i + 1]) || (this.navIndex !== i) && (i === length - 1 && this.DetailScrollY[i] <=\r\n          //     positionY)) {\r\n          //   console.log(i);\r\n          //   this.navIndex = i;\r\n          //   this.$refs.detailNavBar.detailType = i\r\n          // }\r\n\r\n          //2 、在this.DetailScrollY 后添加多一个数字\r\n          if ((this.navIndex !== i) && (i < length - 1 && this.DetailScrollY[i] <= positionY && positionY < this\r\n              .DetailScrollY[i + 1])) {\r\n            this.navIndex = i;\r\n            this.$refs.detailNavBar.detailType = i\r\n          }\r\n        }\r\n      },\r\n      //点解标题到对应内容\r\n      titleClick(index) {\r\n        this.$refs.scroll.backtop(0, -this.DetailScrollY[index], 100)\r\n      },\r\n      //添加数据到购物车\r\n      addToCart() {\r\n        const product = {}\r\n        product.image = this.DetailSwiperImage[0];\r\n        product.title = this.goods.title;\r\n        product.desc = this.goods.desc;\r\n        product.price = this.goods.lowNowPrice;\r\n        product.iid = this.iid;\r\n        this.$store.dispatch('addCart', product).then(res => {\r\n          this.$toast.show(res)\r\n        })\r\n      },\r\n\r\n      //获取到所有的数据\r\n      getdetaildata(iid) {\r\n        getdetaildata(iid).then(res => {\r\n          let data = res.result;\r\n          this.DetailSwiperImage = data.itemInfo.topImages;\r\n          //商品信息\r\n          this.goods = new Goods(data.columns, data.itemInfo, data.shopInfo.services)\r\n          //店铺信息\r\n          this.shops = new Shop(data.shopInfo)\r\n          //商品的详细信息\r\n          this.goodsInfo = data.detailInfo\r\n          //保存参数信息\r\n          this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\r\n          //评论\r\n          if (data.rate.list) {\r\n            this.commentInfo = data.rate.list[0];\r\n          }\r\n\r\n        })\r\n      },\r\n      //获取推荐数据\r\n      getRecommend() {\r\n        getRecommend().then(res => {\r\n          this.showGoods = res.data.list\r\n        })\r\n      }\r\n    },\r\n    destroyed() {\r\n      //删除$bus里面的方法\r\n      this.$bus.$off('itemImageLoad', this.listImageLoad)\r\n    }\r\n  }\r\n\r\n</script>\r\n<style scoped>\r\n  .detail-nav {\r\n    position: relative;\r\n    z-index: 10;\r\n    background-color: #fff;\r\n  }\r\n\r\n  .detail-scroll {\r\n    position: fixed;\r\n    top: 44px;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 49px;\r\n    overflow: hidden;\r\n    z-index: 9;\r\n    background-color: #fff;\r\n  }\r\n\r\n</style>\r\n"]}]}